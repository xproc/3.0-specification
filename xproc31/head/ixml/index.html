<html xmlns="http://www.w3.org/1999/xhtml"><head><title>XProc 3.1: Invisible XML</title><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" /><link class="removeOnSave" crossorigin="anonymous" href="https://www.w3.org" rel="preconnect" /><link as="script" class="removeOnSave" href="js/fixup.js" rel="preload" /><link as="style" class="removeOnSave" href="css/base.css" rel="preload" /><link as="image" class="removeOnSave" href="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" rel="preload" /><link rel="stylesheet" href="css/cg-draft.css" /><link rel="stylesheet" href="css/respec.css" /><link rel="alternate" title="XML" href="specification.xml" /><meta name="generator" content="DocBook XSL 2.0 Stylesheets V2.5.0" /><meta name="description" content="Abstract This specification describes the p:invisible-xml&#xA;step for&#xA;XProc 3.1: An XML Pipeline Language." /><link href="css/default.css" rel="stylesheet" type="text/css" /><link href="css/db-prism.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="css/base.css" /><link rel="stylesheet" type="text/css" href="css/xproc.css" /><link rel="stylesheet" type="text/css" href="css/print.css" media="print" /><script type="text/javascript" src="js/dbmodnizr.js"></script></head><body class="h-entry informative toc-sidebar"><div class="head" id="spec.head"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72" /></a><h1 id="title" class="title p-name">XProc 3.1: Invisible XML</h1><h2>Community Group Report <time class="dt-published" datetime="2025-05-30">30 May 2025</time></h2><dl><dt>Specification:</dt><dd><a href="https://spec.xproc.org/3.1/ixml/">https://spec.xproc.org/3.1/ixml/</a></dd><dt>Editor:</dt><dd><span class="personname">Norman Walsh</span></dd><dt>Participate:</dt><dd><a href="http://github.com/xproc/3.0-steps">GitHub xproc/3.0-steps</a></dd><dd><a href="http://github.com/xproc/3.0-steps/issues">Report an issue</a></dd><dt>Errata:</dt><dd><a href="https://specs.xproc.org/3.1/xproc/errata.html">https://specs.xproc.org/3.1/xproc/errata.html</a></dd></dl><p>This document is also available in these non-normative formats: <a href="specification.xml">XML</a>.</p><p class="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © <span class="years">2021, 2022, 2023, 2024, 2025</span> the Contributors to the <cite>XProc 3.1: Invisible XML</cite> specification, published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C
    Community Contributor License Agreement (CLA)</a>. A human-readable <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.</p><hr title="Separator for header" /><section id="abstract" class="introductory"><h2>Abstract</h2>
<p>This specification describes the <code class="code">p:invisible-xml</code>
step for
<em class="citetitle">XProc 3.1: An XML Pipeline Language</em>.</p>
</section><section id="sotd" class="introductory"><h2>Status of this Document</h2>
  <p>This specification was published by the
  <a href="https://www.w3.org/community/xproc-next/">XProc
  Next Community Group</a>. It is not a W3C Standard nor is it on
  the W3C Standards Track. Please note that under the
  <a href="https://www.w3.org/community/about/agreements/cla/">W3C
  Community Contributor License Agreement (CLA)</a> there is a limited
  opt-out and other conditions apply. Learn more about <a href="https://www.w3.org/community/">W3C Community and Business
  Groups</a>.
  </p>
  
  <p>If you wish to make comments regarding this document, please
  send them to
  <a href="mailto:xproc-dev@w3.org">xproc-dev@w3.org</a>.
  (<a href="mailto:xproc-dev-request@w3.org?subject=subscribe">subscribe</a>,
  <a href="https://lists.w3.org/Archives/Public/xproc-dev/">archives</a>).
  </p>

</section></div><div class="lists-of-titles"><nav id="toc"><h2 id="TableOfContents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#library"><bdi class="secno">2. </bdi>Step library</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#c.ixml"><bdi class="secno">2.1. </bdi>p:invisible-xml</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#example-ixml"><bdi class="secno">2.1.1. </bdi>Examples</a></li><li class="tocline"><a class="tocxref" href="#c.ixml.9"><bdi class="secno">2.1.2. </bdi>Formerly the <code class="code">p:ixml</code> step</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#errors"><bdi class="secno">3. </bdi>Step Errors</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">A. </bdi>Conformance</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#implementation-defined"><bdi class="secno">A.1. </bdi>Implementation-defined features</a></li><li class="tocline"><a class="tocxref" href="#implementation-dependent"><bdi class="secno">A.2. </bdi>Implementation-dependent features</a></li></ul></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>References</a></li><li class="tocline"><a class="tocxref" href="#glossary"><bdi class="secno">C. </bdi>Glossary</a></li><li class="tocline"><a class="tocxref" href="#ancillary-files"><bdi class="secno">D. </bdi>Ancillary files</a></li></ol></nav></div><article class="specification">


<section id="introduction" class="section"><div class="section-titlepage"><h2><bdi class="secno">1. </bdi>Introduction<a aria-label="§" class="self-link" href="#introduction"></a></h2></div><div class="content">


<p>This specification describes the <code class="code">p:invisible-xml</code> XProc step.
A machine-readable description of this step may be found in
<a href="steps.xpl">steps.xpl</a>.
</p>
  
<p>Familarity with the general nature of [<a href="#xproc31"><span class="abbrev">XProc 3.1</span></a>]
steps is assumed.</p>
</div></section>

<section id="library" class="section"><div class="section-titlepage"><h2><bdi class="secno">2. </bdi>Step library<a aria-label="§" class="self-link" href="#library"></a></h2></div><div class="content">


<section id="c.ixml" class="section"><div class="section-titlepage"><h3><bdi class="secno">2.1. </bdi>p:invisible-xml<a aria-label="§" class="self-link" href="#c.ixml"></a></h3></div><div class="content">


<p>The <code class="tag-element">p:invisible-xml</code> step performs Invisible XML processing per
[<a href="#invisible-xml"><span class="abbrev">Invisible XML</span></a>]. It transforms a non-XML input into XML by applying
the specified Invisible XML grammar.</p>

<div class="declare-step"><p>Summary</p><table class="tableaux"><thead><tr><th class="port">Input port</th><th class="check">Primary</th><th class="check">Sequence</th><th>Content types</th></tr></thead><tbody><tr><td><a href="#port.inline.grammar-1">grammar</a></td><td class="check"> </td><td class="check">✔ </td><td>text xml </td></tr><tr><td class="primary"><a href="#port.inline.source-1">source</a></td><td class="check">✔ </td><td class="check"> </td><td>any -xml -html </td></tr></tbody></table><table class="tableaux"><thead><tr><th class="port">Output port</th><th class="check">Primary</th><th class="check">Sequence</th><th>Content types</th></tr></thead><tbody><tr><td class="primary"><a href="#port.inline.result-1">result</a></td><td class="check">✔ </td><td class="check">✔ </td><td>any </td></tr></tbody></table><table class="tableaux"><thead><tr><th>Option name</th><th>Type</th><th>Default value</th></tr></thead><tbody><tr><td><a href="#opt.inline.fail-on-error-1">fail-on-error</a></td><td>xs:boolean</td><td>true()</td></tr><tr><td><a href="#opt.inline.parameters-1">parameters</a></td><td>map(xs:QName, item()*)?</td><td>()</td></tr></tbody></table><details><summary>Errors</summary><table class="tableaux"><thead><tr><th>Error code</th><th>Description</th></tr></thead><tbody><tr><td class="errcode"><a href="#err.inline.C0205&#34;">err:XC0205</a></td><td class="description">It is a dynamic error
if the source document cannot be parsed by the provided grammar.</td></tr><tr><td class="errcode"><a href="#err.inline.C0211&#34;">err:XC0211</a></td><td class="description">It is a dynamic error if more than one
document appears on the grammar port.</td></tr><tr><td class="errcode"><a href="#err.inline.C0212&#34;">err:XC0212</a></td><td class="description">It is a dynamic error if the grammar
provided is not a valid Invisible XML grammar.</td></tr></tbody></table></details><details><summary>Implementation details</summary><table class="tableaux"><thead><tr><th>Implementation</th><th>Description</th></tr></thead><tbody><tr><td><a href="#impl-1">Defined</a></td><td class="description">It is implementation-defined if other result
formats are possible.</td></tr><tr><td><a href="#impl-2">Defined</a></td><td class="description">The parameters are 
implementation-defined.</td></tr><tr><td><a href="#impl-3">Defined</a></td><td class="description">Support for the alternative name p:ixml
is implementation-defined.</td></tr></tbody></table></details><details><summary>Declaration</summary><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:invisible-xml</code><code>"</code><code>&gt;</code></span><br />     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">grammar</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code> <code class="attr content-types-attr">content-types</code><code>="</code><code class="value content-types-value">text xml</code><code>"</code><code>/&gt;</code></span><br />     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code> <code class="attr content-types-attr">content-types</code><code>="</code><code class="value content-types-value">any -xml -html</code><code>"</code><code>/&gt;</code></span><br />     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code> <code class="attr content-types-attr">content-types</code><code>="</code><code class="value content-types-value">any</code><code>"</code><code>/&gt;</code></span><br />     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">parameters</code><code>"</code> <code class="attr as-attr">as</code><code>="</code><code class="value as-value">map(xs:QName, item()*)?</code><code>"</code><code>/&gt;</code><code>    </code></span><br />     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">fail-on-error</code><code>"</code> <code class="attr as-attr">as</code><code>="</code><code class="value as-value">xs:boolean</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">true()</code><code>"</code><code>/&gt;</code><code></code></span><br /><code>&lt;/p:declare-step&gt;</code></p></details></div>

<p>If no grammar is provided on the <a id="port.inline.grammar-1"></a><code class="port">grammar</code> port, the grammar for
Invisible XML is assumed. If an XML or text grammar is provided it
<span class="rfc2119" id="c.ixml.4.2">must</span> be an Invisible XML grammar. 
<a id="err.inline.C0212&#34;"></a>It is a <em class="glossterm"><a href="#dt-dynamic-error">dynamic error</a></em> (<a href="#err.C0212"><code class="errqname">err:XC0212</code></a>) if the grammar
provided is not a valid Invisible XML grammar.
<a id="err.inline.C0211&#34;"></a>It is a <em class="glossterm"><a href="#dt-dynamic-error">dynamic error</a></em> (<a href="#err.C0211"><code class="errqname">err:XC0211</code></a>) if more than one
document appears on the <a id="port.inline.grammar-2"></a><code class="port">grammar</code> port.</p>

<p>The <a id="port.inline.source-1"></a><code class="port">source</code> to be processed is usually text, but
there’s nothing in principle that prevents an Invisible XML grammar
from applying to an arbitrary sequence of characters.</p>

<p>The <a id="port.inline.result-1"></a><code class="port">result</code> <span class="rfc2119" id="c.ixml.6.2">should</span> be XML. 
<span id="impl-1">It is <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em> if other result
formats are possible.</span> (An implementation might, for example, provide a
way for the <code class="tag-element">p:invisible-xml</code> step to compile an Invisible XML grammar into some
format that can be processed more efficiently.)</p>

<div class="itemizedlist">


<ul><li>
<p><span id="impl-2">The <a id="opt.inline.parameters-1"></a><code class="option">parameters</code> are 
<em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em>.</span> An implementation might
provide parameters to select among different ambiguous parses or choose
alternate representations.</p>
</li><li>
<p>If <a id="opt.inline.fail-on-error-1"></a><code class="option">fail-on-error</code> is <code class="code">true</code>, the step will
raise an error if the input cannot be parsed by the grammar.
<a id="err.inline.C0205&#34;"></a>It is a <em class="glossterm"><a href="#dt-dynamic-error">dynamic error</a></em> (<a href="#err.C0205"><code class="errqname">err:XC0205</code></a>)
if the source document cannot be parsed by the provided grammar.
If <a id="opt.inline.fail-on-error-2"></a><code class="option">fail-on-error</code> is <code class="code">false</code>, no error will be raised.
</p>
<p>The Invisible XML specification provides a mechanism to identify failed parses
in the output.</p>
</li></ul></div>

<section id="example-ixml" class="section"><div class="section-titlepage"><h4><bdi class="secno">2.1.1. </bdi>Examples<a aria-label="§" class="self-link" href="#example-ixml"></a></h4></div><div class="content">


<p>Several examples demonstrate features of the step.</p>

<section id="example-parse-ixml" class="section"><div class="section-titlepage"><h5><bdi class="secno">2.1.1.1. </bdi>Parsing an Invisible XML grammar<a aria-label="§" class="self-link" href="#example-parse-ixml"></a></h5></div><div class="content">


<p>In this first example, no grammar is provided, so the pipeline parses the
Invisible XML grammar on the <a id="port.inline.source-2"></a><code class="port">source</code> port and returns its XML
representation:</p>

<pre class="programlisting language-markup xml"><code>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                version="3.1"&gt;
&lt;p:output port="result"/&gt;

&lt;p:ixml&gt;
  &lt;p:with-input port="grammar"&gt;&lt;p:empty /&gt;&lt;/p:with-input&gt;
  &lt;p:with-input port="source"&gt;
    &lt;p:inline content-type="text/plain"&gt;
date: s?, day, s, month, (s, year)? .
-s: -" "+ .
day: digit, digit? .
-digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9".
month: "January"; "February"; "March"; "April";
       "May"; "June"; "July"; "August";
       "September"; "October"; "November"; "December".
year: (digit, digit)?, digit, digit .
    &lt;/p:inline&gt;
  &lt;/p:with-input&gt;
&lt;/p:ixml&gt;

&lt;/p:declare-step&gt;</code></pre>

<p>This would produce an XML version of the grammar:</p>

<pre class="programlisting language-markup xml"><code>&lt;ixml&gt;
   &lt;rule name="date"&gt;
      &lt;alt&gt;
         &lt;option&gt;
            &lt;nonterminal name="s"/&gt;
         &lt;/option&gt;
         &lt;nonterminal name="day"/&gt;
         &lt;nonterminal name="s"/&gt;
         &lt;nonterminal name="month"/&gt;
         &lt;option&gt;
            &lt;alts&gt;
               &lt;alt&gt;
                  &lt;nonterminal name="s"/&gt;
                  &lt;nonterminal name="year"/&gt;
               &lt;/alt&gt;
            &lt;/alts&gt;
         &lt;/option&gt;
      &lt;/alt&gt;
   &lt;/rule&gt;
   &lt;!-- … remaining rules elided for brevity … --&gt;
&lt;/ixml&gt;</code></pre>

</div></section>
<section id="example-parse-date" class="section"><div class="section-titlepage"><h5><bdi class="secno">2.1.1.2. </bdi>Parsing a date<a aria-label="§" class="self-link" href="#example-parse-date"></a></h5></div><div class="content">


<p>If the grammar is provided on the <a id="port.inline.grammar-3"></a><code class="port">grammar</code> port, it can be
used to parse input, the string “31 December 2021” in this case:</p>

<pre class="programlisting language-markup xml"><code>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                version="3.1"&gt;
&lt;p:output port="result"/&gt;

&lt;p:ixml&gt;
  &lt;p:with-input port="grammar"&gt;
    &lt;p:inline content-type="text/plain"&gt;
date: s?, day, s, month, (s, year)? .
-s: -" "+ .
day: digit, digit? .
-digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9".
month: "January"; "February"; "March"; "April";
       "May"; "June"; "July"; "August";
       "September"; "October"; "November"; "December".
year: (digit, digit)?, digit, digit .
    &lt;/p:inline&gt;
  &lt;/p:with-input&gt;
  &lt;p:with-input port="source"&gt;
    &lt;p:inline content-type="text/plain"&gt;31 December 2021&lt;/p:inline&gt;
  &lt;/p:with-input&gt;
&lt;/p:ixml&gt;

&lt;/p:declare-step&gt;</code></pre>

<p>This would produce an XML version of the date:</p>

<pre class="programlisting language-markup xml"><code>&lt;date&gt;&lt;day&gt;31&lt;/day&gt;&lt;month&gt;December&lt;/month&gt;&lt;year&gt;2021&lt;/year&gt;&lt;/date&gt;</code></pre>

</div></section>
<section id="example-parse-fail" class="section"><div class="section-titlepage"><h5><bdi class="secno">2.1.1.3. </bdi>Failed parses<a aria-label="§" class="self-link" href="#example-parse-fail"></a></h5></div><div class="content">


<p>If a parse fails, the implementation <span class="rfc2119" id="example-parse-fail.2.1">must</span> indicate
this, but it may also provide information about where the processing failed.</p>

<pre class="programlisting language-markup xml"><code>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                version="3.1"&gt;
&lt;p:output port="result"/&gt;

&lt;p:ixml fail-on-error="false"&gt;
  &lt;p:with-input port="grammar"&gt;
    &lt;p:inline content-type="text/plain"&gt;
date: s?, day, s, month, (s, year)? .
-s: -" "+ .
day: digit, digit? .
-digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9".
month: "January"; "February"; "March"; "April";
       "May"; "June"; "July"; "August";
       "September"; "October"; "November"; "December".
year: (digit, digit)?, digit, digit .
    &lt;/p:inline&gt;
  &lt;/p:with-input&gt;
  &lt;p:with-input port="source"&gt;
    &lt;p:inline content-type="text/plain"&gt;31 Mumble 2021&lt;/p:inline&gt;
  &lt;/p:with-input&gt;
&lt;/p:ixml&gt;

&lt;/p:declare-step&gt;</code></pre>

<p>Here the output might be something like this:</p>

<pre class="programlisting language-markup xml"><code>&lt;error xmlns:ixml="http://invisiblexml.org/NS"
       xmlns:ex="http://example.com/NS"
       ixml:state="failed" ex:lastChar="4"&gt;
&lt;parse&gt;
month -&gt;  •  M  a  r  c  h
month -&gt;  M  •  a  r  c  h
&lt;/parse&gt;
&lt;parse&gt;
month -&gt;  •  M  a  y
month -&gt;  M  •  a  y
&lt;/parse&gt;
&lt;/error&gt;</code></pre>

<p>In the case of failure, Invisible XML requires that the <code class="tag-attribute">ixml:state</code> attribute appear on the root element
containing the token “<code class="code">failed</code>”. It doesn’t constrain the implementation’s
choice of the root element or the content of the document.
</p>

</div></section>
<section id="example-parse-ambiguous-1" class="section"><div class="section-titlepage"><h5><bdi class="secno">2.1.1.4. </bdi>Ambiguous parses<a aria-label="§" class="self-link" href="#example-parse-ambiguous-1"></a></h5></div><div class="content">


<p>An ixml grammar may be ambiguous. In the grammar below, there are three
different possible ways to parse the input. By default, one of them is returned.
</p>

<pre class="programlisting language-markup xml"><code>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                version="3.1"&gt;
&lt;p:output port="result"/&gt;

&lt;p:ixml&gt;
  &lt;p:with-input port="grammar"&gt;
    &lt;p:inline content-type="text/plain"&gt;
letters: X, (A; B; C) .
A: digits .
B: digits .
C: digits .
X: "a" .
digits: ["0"-"9"]+ .
    &lt;/p:inline&gt;
  &lt;/p:with-input&gt;
  &lt;p:with-input port="source"&gt;
    &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt;
  &lt;/p:with-input&gt;
&lt;/p:ixml&gt;

&lt;/p:declare-step&gt;</code></pre>

<p>This might return any one of these parses:</p>

<pre class="programlisting language-markup xml"><code>&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;C&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/C&gt;&lt;/letters&gt;</code></pre>

<p>or</p>

<pre class="programlisting language-markup xml"><code>&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</code></pre>

<p>or</p>

<pre class="programlisting language-markup xml"><code>&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;B&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/B&gt;&lt;/letters&gt;</code></pre>

<p>All are equally correct.</p>
</div></section>

<section id="example-parse-ambiguous-2" class="section"><div class="section-titlepage"><h5><bdi class="secno">2.1.1.5. </bdi>Ambiguous parse selection<a aria-label="§" class="self-link" href="#example-parse-ambiguous-2"></a></h5></div><div class="content">


<p>An implementation might provide a parameter to allow the author to
select a particular parse:
</p>

<pre class="programlisting language-markup xml"><code>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                xmlns:ex="http://example.com/"
                version="3.1"&gt;
&lt;p:output port="result"/&gt;

&lt;p:ixml parameters="map{'ex:select':2}"&gt;
  &lt;p:with-input port="grammar"&gt;
    &lt;p:inline content-type="text/plain"&gt;
letters: X, (A; B; C) .
A: digits .
B: digits .
C: digits .
X: "a" .
digits: ["0"-"9"]+ .
    &lt;/p:inline&gt;
  &lt;/p:with-input&gt;
  &lt;p:with-input port="source"&gt;
    &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt;
  &lt;/p:with-input&gt;
&lt;/p:ixml&gt;

&lt;/p:declare-step&gt;</code></pre>

<p>This might return:</p>

<pre class="programlisting language-markup xml"><code>&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</code></pre>
</div></section>

<section id="example-parse-ambiguous-3" class="section"><div class="section-titlepage"><h5><bdi class="secno">2.1.1.6. </bdi>Multiple ambiguous outputs<a aria-label="§" class="self-link" href="#example-parse-ambiguous-3"></a></h5></div><div class="content">


<p>Or a processor might provide a parameter to return all of the parses.</p>

<pre class="programlisting language-markup xml"><code>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                xmlns:ex="http://example.com/"
                version="3.1"&gt;
&lt;p:output port="result"/&gt;

&lt;p:ixml parameters="map{'ex:select':'all'}"&gt;
  &lt;p:with-input port="grammar"&gt;
    &lt;p:inline content-type="text/plain"&gt;
letters: X, (A; B; C) .
A: digits .
B: digits .
C: digits .
X: "a" .
digits: ["0"-"9"]+ .
    &lt;/p:inline&gt;
  &lt;/p:with-input&gt;
  &lt;p:with-input port="source"&gt;
    &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt;
  &lt;/p:with-input&gt;
&lt;/p:ixml&gt;

&lt;/p:declare-step&gt;</code></pre>

<p>This might return three documents:</p>

<pre class="programlisting language-markup xml"><code>&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;C&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/C&gt;&lt;/letters&gt;
&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;B&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/B&gt;&lt;/letters&gt;
&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</code></pre>

<p>As before, there is nothing standardized about the results in this case.</p>
</div></section>
</div></section>

<section id="c.ixml.9" class="section"><div class="section-titlepage"><h4><bdi class="secno">2.1.2. </bdi>Formerly the <code class="code">p:ixml</code> step<a aria-label="§" class="self-link" href="#"></a></h4></div><div class="content">


<p>In earlier drafts of this specification, the <code class="tag-element">p:invisible-xml</code> step
was named <code class="code">p:ixml</code>. Changing the name of the step to <code class="tag-element">p:invisible-xml</code>
brings the name into better alignment with the naming conventions used for most other
XProc steps and aligns its name with the <code class="code">fn:invisible-xml()</code> function
in XPath 4.0.</p>

<p>Implementors may wish to support both names for some period of time in order
to avoid breaking changes in existing pipelines. <span id="impl-3">Support for the alternative name <code class="code">p:ixml</code>
is <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em>.</span></p>
</div></section>
  
<section id="c.ixml.10" class="simplesect"><div class="section-titlepage"><h4>Document properties</h4></div><div class="content">

<p>No document properties are preserved.</p>
</div></section>
</div></section>
</div></section>

<section id="errors" class="section"><div class="section-titlepage"><h2><bdi class="secno">3. </bdi>Step Errors<a aria-label="§" class="self-link" href="#errors"></a></h2></div><div class="content">


<p>This step can raise
<em class="glossterm"><a href="#dt-dynamic-error">dynamic errors</a></em>.
</p>

<p><span id="dt-dynamic-error" class="termdef">[Definition: A <em class="glossterm">dynamic
error</em> is one which occurs while a pipeline is being
evaluated.]</span> Examples of dynamic errors include references to
URIs that cannot be resolved, steps which fail, and pipelines that
exhaust the capacity of an implementation (such as memory or disk
space). For a more complete discussion of dynamic errors, see
<cite><a href="https://spec.xproc.org/3.1/ixml//#dynamic-errors">Dynamic Errors</a></cite> in <cite><a href="https://spec.xproc.org/3.1/ixml//">XProc 3.0: An XML Pipeline Language</a></cite>.
</p>

<p>If a step fails due to a dynamic error, failure propagates
upwards until either a <code class="tag-element">p:try</code> is encountered or the entire
pipeline fails. In other words, outside of a <code class="tag-element">p:try</code>, step
failure causes the entire pipeline to fail.</p>

<p>The following errors can be raised by this step:</p>

<div id="step-error-summary"><dl class="errs"><dt id="err.C0205"><code class="errqname">err:XC0205</code></dt><dd><p>It is a dynamic error
if the source document cannot be parsed by the provided grammar.</p><p>See: <a href="#err.inline.C0205">p:invisible-xml</a></p></dd><dt id="err.C0211"><code class="errqname">err:XC0211</code></dt><dd><p>It is a dynamic error if more than one
document appears on the grammar port.</p><p>See: <a href="#err.inline.C0211">p:invisible-xml</a></p></dd><dt id="err.C0212"><code class="errqname">err:XC0212</code></dt><dd><p>It is a dynamic error if the grammar
provided is not a valid Invisible XML grammar.</p><p>See: <a href="#err.inline.C0212">p:invisible-xml</a></p></dd></dl></div>

</div></section>

<article id="conformance" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">A. </bdi>Conformance<a aria-label="§" class="self-link" href="#conformance"></a></h2></header><div class="content">


<p>Conformant processors <span class="rfc2119" id="conformance.2.1">must</span> implement all of the features
described in this specification except those that are explicitly identified
as optional.</p>

<p>Some aspects of processor behavior are not completely specified; those
features are either <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> or
<em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em>.</p>

<p><span id="dt-implementation-dependent" class="termdef">[Definition: An
<em class="glossterm">implementation-dependent</em> feature is one where the
implementation has discretion in how it is performed.
Implementations are not required to document or explain
how <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> features are performed.]</span>
</p>

<p><span id="dt-implementation-defined" class="termdef">[Definition: An
<em class="glossterm">implementation-defined</em> feature is one where the
implementation has discretion in how it is performed.
Conformant implementations <span class="rfc2119" id="dt-implementation-defined.2">must</span> document
how <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em> features are performed.]</span>
</p>

<section id="implementation-defined" class="section"><div class="section-titlepage"><h2><bdi class="secno">A.1. </bdi>Implementation-defined features<a aria-label="§" class="self-link" href="#implementation-defined"></a></h2></div><div class="content">


<p>The following features are implementation-defined:</p>

<ol class="features"><li>It is implementation-defined if other result
formats are possible. See <a href="#c.ixml" title="p:invisible-xml">Section 2.1, “p:invisible-xml”</a>.</li><li>The parameters are 
implementation-defined. See <a href="#c.ixml" title="p:invisible-xml">Section 2.1, “p:invisible-xml”</a>.</li><li>Support for the alternative name p:ixml
is implementation-defined. See <a href="#c.ixml" title="p:invisible-xml">Section 2.1, “p:invisible-xml”</a>.</li></ol>
</div></section>

<section id="implementation-dependent" class="section"><div class="section-titlepage"><h2><bdi class="secno">A.2. </bdi>Implementation-dependent features<a aria-label="§" class="self-link" href="#implementation-dependent"></a></h2></div><div class="content">


<p>This step has no implementation-dependent features.</p>

<ol class="features"></ol>
</div></section>
</div></article>

<article id="references" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">B. </bdi>References<a aria-label="§" class="self-link" href="#references"></a></h2></header><div class="content">

<div id="references.2" class="bibliolist">
<div id="xproc31" class="bibliomixed"><p>[<span class="abbrev">XProc 3.1</span>] 
<a href="https://spec.xproc.org/lastcall-2024-08/head/xproc/"><span class="citetitle"><cite>XProc 3.1:
An XML Pipeline Language</cite></span></a>.
Norman Walsh, Achim Berndzen, Gerrit Imsieke and Erik Siegel, editors.
</p></div>
<div id="invisible-xml" class="bibliomixed"><p>[<span class="abbrev">Invisible XML</span>] 
<a href="https://invisiblexml.org/1.0/"><span class="citetitle"><cite>Invisible XML
Specification</cite></span></a>, version 1.0.
Steven Pemberton, editor. Version 2022-06-20.
</p></div>
</div>
</div></article>


<article id="glossary" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">C. </bdi>Glossary<a aria-label="§" class="self-link" href="#glossary"></a></h2></header><div class="content"><div class="glosslist"><dl><dt id="glossary.2.1" class="glossentry"><em class="glossterm"><a href="#dt-dynamic-error">dynamic
error</a></em></dt><dd class="glossdef"><p>A <em class="firstterm">dynamic
error</em> is one which occurs while a pipeline is being
evaluated.</p></dd><dt id="glossary.2.2" class="glossentry"><em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em></dt><dd class="glossdef"><p>An
<em class="firstterm">implementation-defined</em> feature is one where the
implementation has discretion in how it is performed.
Conformant implementations <span class="rfc2119" id="glossary.2.2.2.1.2">must</span> document
how <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em> features are performed.</p></dd><dt id="glossary.2.3" class="glossentry"><em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em></dt><dd class="glossdef"><p>An
<em class="firstterm">implementation-dependent</em> feature is one where the
implementation has discretion in how it is performed.
Implementations are not required to document or explain
how <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> features are performed.</p></dd></dl></div></div></article>

<article id="ancillary-files" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">D. </bdi>Ancillary files<a aria-label="§" class="self-link" href="#ancillary-files"></a></h2></header><div class="content">


<p>This specification includes by reference a number of
ancillary files.</p>

<div class="variablelist">

<dl><dt><span class="term"><a href="steps.xpl">steps.xpl</a></span></dt><dd>
<p>An XProc step library for the declared steps.
</p>
</dd></dl></div>

</div></article>

</article><script src="js/prism.js"></script><script src="js/fixup.js"></script></body></html>